:host {
  @apply block min-h-screen;
}

.app {
  --bg-primary: #0a0a0f;
  --bg-secondary: #12121a;
  --bg-tertiary: #1a1a24;
  --bg-hover: #22222e;
  --border: #2a2a3a;
  --text: #e8e8f0;
  --text-muted: #6b6b80;
  --accent: #6c5ce7;
  --accent-hover: #7d6ef0;
  --do: #ff6b6b;
  --plan: #4ecdc4;
  --delegate: #ffa502;
  --eliminate: #636e72;
  --success: #00b894;
  --warning: #fdcb6e;
  --danger: #d63031;
  --sidebar-width: 260px;
  --sidebar-collapsed: 70px;
  --topbar-height: 60px;

  @apply font-body min-h-screen flex;
  background: var(--bg-primary);
  color: var(--text);
}

.app.light {
  --bg-primary: #f8f9fa;
  --bg-secondary: #ffffff;
  --bg-tertiary: #f1f3f4;
  --bg-hover: #e8eaed;
  --border: #dadce0;
  --text: #202124;
  --text-muted: #5f6368;
}

/* SCROLLBAR */
::-webkit-scrollbar {
  @apply w-2 h-2;
}

::-webkit-scrollbar-track {
  background: var(--bg-primary);
}

::-webkit-scrollbar-thumb {
  @apply rounded;
  background: var(--border);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

::-webkit-scrollbar-corner {
  background: var(--bg-primary);
}

* {
  scrollbar-width: thin;
  scrollbar-color: var(--border) var(--bg-primary);
}

/* SIDEBAR */
.sidebar {
  @apply h-screen fixed left-0 top-0 flex flex-col z-[100] transition-all duration-200;
  width: var(--sidebar-width);
  background: var(--bg-secondary);
  border-right: 1px solid var(--border);
}

.sidebar.collapsed {
  width: var(--sidebar-collapsed);
}

.sidebar.collapsed .logo-text,
.sidebar.collapsed .project-name,
.sidebar.collapsed .chevron,
.sidebar.collapsed .sidebar-search span,
.sidebar.collapsed .sidebar-search kbd,
.sidebar.collapsed .nav-label,
.sidebar.collapsed .sidebar-nav a span,
.sidebar.collapsed .nav-badge,
.sidebar.collapsed .footer-btn span,
.sidebar.collapsed .project-dropdown {
  @apply hidden;
}

.sidebar.collapsed .sidebar-search {
  @apply justify-center p-3;
}

.sidebar.collapsed .sidebar-nav a {
  @apply justify-center p-3;
}

.sidebar.collapsed .footer-btn {
  @apply justify-center;
}

.sidebar.collapsed .project-selector {
  @apply justify-center p-3;
}

.sidebar-header {
  @apply flex items-center justify-between p-4;
  border-bottom: 1px solid var(--border);
}

.logo {
  @apply flex items-center gap-3 cursor-pointer;
}

.logo i {
  @apply text-2xl;
  color: var(--accent);
}

.logo-text {
  @apply text-lg font-bold bg-clip-text;
  background: linear-gradient(135deg, var(--accent), #a29bfe);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.collapse-btn {
  @apply w-7 h-7 rounded-md flex items-center justify-center text-xs cursor-pointer;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text-muted);
}

.collapse-btn:hover {
  background: var(--bg-hover);
  color: var(--text);
}

/* Project Selector */
.sidebar-section {
  @apply p-3 relative;
}

.project-selector {
  @apply flex items-center gap-2.5 px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-200;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
}

.project-selector:hover {
  background: var(--bg-hover);
  border-color: var(--accent);
}

.project-selector i:first-child {
  @apply text-base;
}

.project-name {
  @apply flex-1 text-sm font-medium truncate;
}

.chevron {
  @apply text-[10px];
  color: var(--text-muted);
}

.project-dropdown {
  @apply absolute left-3 right-3 rounded-lg z-[200] mt-1 overflow-hidden;
  top: 100%;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
}

.dropdown-item {
  @apply flex items-center gap-2.5 px-3 py-2.5 cursor-pointer text-[13px] transition-all duration-150;
}

.dropdown-item:hover {
  background: var(--bg-hover);
}

.dropdown-item.active {
  background: var(--accent);
  @apply text-white;
}

.dropdown-item.active i {
  @apply text-white #{!important};
}

.dropdown-item .count {
  @apply ml-auto text-[11px] px-2 py-0.5 rounded-xl;
  color: var(--text-muted);
  background: var(--bg-tertiary);
}

.dropdown-item.active .count {
  @apply text-white;
  background: rgba(255, 255, 255, 0.2);
}

.dropdown-item.manage {
  color: var(--accent);
}

.dropdown-divider {
  @apply my-1;
  height: 1px;
  background: var(--border);
}

/* Search */
.sidebar-search {
  @apply flex items-center gap-2.5 mx-3 mb-3 px-3 py-2.5 rounded-lg cursor-pointer text-[13px] transition-all duration-200;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text-muted);
}

.sidebar-search:hover {
  background: var(--bg-hover);
  border-color: var(--accent);
  color: var(--text);
}

.sidebar-search kbd {
  @apply ml-auto text-[10px] px-1.5 py-0.5 rounded font-sans;
  background: var(--bg-primary);
  border: 1px solid var(--border);
}

/* Navigation */
.sidebar-nav {
  @apply flex-1 overflow-y-auto px-3;
}

.nav-group {
  @apply mb-4;
}

.nav-label {
  @apply text-[11px] font-semibold uppercase tracking-wide px-3 pt-2 pb-1.5;
  color: var(--text-muted);
}

.sidebar-nav a {
  @apply flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm no-underline relative transition-all duration-150;
  color: var(--text-muted);
}

.sidebar-nav a:hover {
  @apply translate-x-1;
  background: var(--bg-hover);
  color: var(--text);
}

.sidebar-nav a.active {
  background: var(--accent);
  @apply text-white;
}

.sidebar-nav a.disabled {
  @apply opacity-40 pointer-events-none cursor-not-allowed;
}

.sidebar-nav a i {
  @apply w-[18px] text-center text-[15px];
}

.nav-badge {
  @apply ml-auto text-[10px] px-[7px] py-0.5 rounded-xl font-semibold text-white;
  background: var(--danger);
}

/* Sidebar Footer */
.sidebar-footer {
  @apply p-3 flex flex-col gap-1;
  border-top: 1px solid var(--border);
}

.footer-btn {
  @apply flex items-center gap-2.5 px-3 py-2.5 bg-transparent border-none cursor-pointer rounded-lg text-[13px] text-left transition-all duration-150;
  color: var(--text-muted);
}

.footer-btn:hover {
  background: var(--bg-hover);
  color: var(--text);
}

.footer-btn i {
  @apply w-[18px] text-center;
}

/* MAIN WRAPPER */
.main-wrapper {
  @apply flex-1 min-h-screen flex flex-col transition-all duration-200 overflow-x-hidden;
  margin-left: var(--sidebar-width);
  max-width: calc(100vw - var(--sidebar-width));
}

.app.sidebar-collapsed .main-wrapper {
  margin-left: var(--sidebar-collapsed);
  max-width: calc(100vw - var(--sidebar-collapsed));
}

/* TOPBAR */
.topbar {
  @apply flex items-center gap-4 px-5 sticky top-0 z-50;
  height: var(--topbar-height);
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border);
}

.mobile-menu-btn {
  @apply hidden w-10 h-10 rounded-lg text-lg cursor-pointer;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text);
}

.topbar-search {
  @apply flex-1 max-w-[400px] flex items-center gap-2.5 px-4 py-2.5 rounded-lg cursor-pointer transition-all duration-200;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
}

.topbar-search:hover {
  border-color: var(--accent);
}

.topbar-search i {
  color: var(--text-muted);
}

.topbar-search input {
  @apply flex-1 bg-transparent border-none text-sm cursor-pointer outline-none;
  color: var(--text-muted);
}

.topbar-actions {
  @apply flex items-center gap-2 ml-auto;
}

.action-btn {
  @apply w-10 h-10 rounded-lg cursor-pointer relative transition-all duration-200;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text-muted);
}

.action-btn:hover {
  @apply scale-105;
  background: var(--bg-hover);
  color: var(--text);
  border-color: var(--accent);
}

.action-btn.add-btn {
  background: var(--accent);
  border-color: var(--accent);
  @apply text-white;
}

.action-btn.add-btn:hover {
  background: var(--accent-hover);
}

.action-btn.undo-btn,
.action-btn.redo-btn {
  @apply text-sm;
}

.action-btn:disabled {
  @apply opacity-40 cursor-not-allowed;
}

.action-btn:disabled:hover {
  @apply scale-100;
  background: var(--bg-tertiary);
  border-color: var(--border);
  color: var(--text-muted);
}

.action-badge {
  @apply absolute -top-1 -right-1 text-[10px] px-1.5 py-0.5 rounded-xl font-semibold text-white;
  background: var(--danger);
}

/* MAIN */
main {
  @apply flex-1 p-6 overflow-x-hidden min-w-0;
}

/* MOBILE */
.mobile-overlay {
  @apply hidden fixed inset-0 z-[99];
  background: rgba(0, 0, 0, 0.5);
}

.mobile-bottom-nav {
  @apply hidden fixed bottom-0 left-0 right-0 z-[100];
  padding: 10px 0;
  padding-bottom: max(10px, env(safe-area-inset-bottom));
  background: var(--bg-secondary);
  border-top: 1px solid var(--border);
  backdrop-filter: blur(10px);
  background: rgba(18, 18, 26, 0.95);
}

.mobile-bottom-nav a {
  @apply flex-1 flex flex-col items-center text-xl p-2 no-underline relative transition-all duration-150;
  color: var(--text-muted);
}

.mobile-bottom-nav a:active {
  @apply scale-90;
}

.mobile-bottom-nav a.active {
  color: var(--accent);
}

.mobile-bottom-nav a.active::after {
  content: '';
  @apply absolute bottom-0 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full;
  background: var(--accent);
}

.mobile-bottom-nav .badge {
  @apply absolute top-0.5 text-[10px] px-1.5 py-0.5 rounded-xl text-white animate-pulse;
  right: 50%;
  transform: translateX(80%);
  background: var(--danger);
}

.fab-center {
  @apply w-[56px] h-[56px] rounded-full border-none text-[22px] cursor-pointer text-white transition-all duration-200;
  background: linear-gradient(135deg, var(--accent), var(--accent-hover));
  margin-top: -28px;
  box-shadow: 0 4px 20px rgba(108, 92, 231, 0.5);
}

.fab-center:active {
  @apply scale-90;
  box-shadow: 0 2px 10px rgba(108, 92, 231, 0.4);
}

/* Mobile Search Bottom Sheet */
.mobile-search-sheet {
  @apply fixed inset-x-0 bottom-0 z-[1001] rounded-t-2xl;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border);
  padding-bottom: env(safe-area-inset-bottom);
  animation: slide-up 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes slide-up {
  0% {
    transform: translateY(100%);
  }
  100% {
    transform: translateY(0);
  }
}

.mobile-search-sheet .sheet-handle {
  @apply w-10 h-1 rounded-full mx-auto my-3;
  background: var(--border);
}

.mobile-search-sheet .sheet-content {
  @apply px-5 pb-5 max-h-[70vh] overflow-y-auto;
}

/* SEARCH MODAL */
.modal-overlay {
  @apply fixed inset-0 flex items-start justify-center pt-[100px] z-[1000];
  background: rgba(0, 0, 0, 0.7);
}

.search-modal {
  @apply w-[90%] max-w-[600px] rounded-xl overflow-hidden;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}

.search-input-wrapper {
  @apply flex items-center gap-3 px-5 py-4;
  border-bottom: 1px solid var(--border);
}

.search-input-wrapper i {
  @apply text-lg;
  color: var(--text-muted);
}

.search-input-wrapper input {
  @apply flex-1 bg-transparent border-none text-base outline-none;
  color: var(--text);
}

.search-input-wrapper kbd {
  @apply text-[11px] px-2 py-1 rounded;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text-muted);
}

.search-filters {
  @apply px-5 py-4 flex flex-col gap-3;
  border-bottom: 1px solid var(--border);
}

.filter-group {
  @apply flex items-center gap-2 flex-wrap;
}

.filter-label {
  @apply text-xs min-w-[60px];
  color: var(--text-muted);
}

.filter-chip {
  @apply flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs cursor-pointer transition-all duration-150;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
}

.filter-chip input {
  @apply hidden;
}

.filter-chip:hover {
  background: var(--bg-hover);
}

.filter-chip.active {
  background: var(--accent);
  border-color: var(--accent);
  @apply text-white;
}

.filter-chip.do.active {
  background: var(--do);
  border-color: var(--do);
}

.filter-chip.plan.active {
  background: var(--plan);
  border-color: var(--plan);
}

.filter-chip.delegate.active {
  background: var(--delegate);
  border-color: var(--delegate);
}

.filter-chip.eliminate.active {
  background: var(--eliminate);
  border-color: var(--eliminate);
}

.filter-row {
  @apply flex items-center justify-between gap-3;
}

.search-btn {
  @apply px-4 py-2 border-none rounded-lg text-[13px] cursor-pointer flex items-center gap-2 text-white;
  background: var(--accent);
}

.search-btn:hover {
  background: var(--accent-hover);
}

.search-results {
  @apply max-h-[300px] overflow-y-auto;
}

.result-item {
  @apply flex items-center gap-3 px-5 py-3 cursor-pointer transition-colors duration-150;
}

.result-item:hover {
  background: var(--bg-hover);
}

.result-priority {
  @apply w-2 h-2 rounded-full;
}

.result-priority.do {
  background: var(--do);
}

.result-priority.plan {
  background: var(--plan);
}

.result-priority.delegate {
  background: var(--delegate);
}

.result-priority.eliminate {
  background: var(--eliminate);
}

.result-title {
  @apply flex-1 text-sm;
}

.result-status {
  @apply text-[11px] px-2.5 py-0.5 rounded-xl;
}

.result-status.todo {
  background: rgba(253, 203, 110, 0.2);
  color: var(--warning);
}

.result-status.in_progress {
  background: rgba(78, 205, 196, 0.2);
  color: var(--plan);
}

.result-status.done {
  background: rgba(0, 184, 148, 0.2);
  color: var(--success);
}

.result-item i {
  @apply text-xs;
  color: var(--text-muted);
}

/* RESPONSIVE */
@media (max-width: 1024px) {
  .sidebar {
    @apply -translate-x-full;
  }

  .sidebar.mobile-open {
    @apply translate-x-0;
  }

  .main-wrapper {
    @apply ml-0 max-w-full;
  }

  .mobile-menu-btn {
    @apply flex items-center justify-center;
  }

  .mobile-overlay {
    @apply block;
  }
}

@media (max-width: 768px) {
  .topbar-search {
    @apply hidden;
  }

  main {
    @apply p-4;
    padding-bottom: calc(100px + env(safe-area-inset-bottom));
  }

  .mobile-bottom-nav {
    @apply flex;
  }

  /* Toasts on mobile - bottom center */
  .toast-container {
    @apply top-auto bottom-24 left-4 right-4 items-center;
    max-width: none;
  }

  .toast {
    @apply w-full;
  }
}

/* TOAST NOTIFICATIONS */
.toast-container {
  @apply fixed top-5 right-5 z-[2000] flex flex-col gap-2.5 max-w-[400px];
}

.toast {
  @apply flex items-center gap-3 px-[18px] py-3.5 rounded-xl cursor-pointer overflow-hidden relative;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
  transition: transform 0.2s, opacity 0.2s;
  animation: toast-enter 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes toast-enter {
  0% {
    transform: translateX(100%);
    opacity: 0;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}

.toast.exiting {
  animation: toast-exit 0.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes toast-exit {
  0% {
    transform: translateX(0);
    opacity: 1;
  }
  100% {
    transform: translateX(100%);
    opacity: 0;
  }
}

.toast:hover {
  @apply -translate-x-[5px];
}

.toast:hover .toast-progress {
  animation-play-state: paused;
}

.toast i {
  @apply text-lg;
}

.toast span {
  @apply flex-1 text-sm;
}

.toast-close {
  @apply bg-transparent border-none cursor-pointer p-1 transition-colors duration-150;
  color: var(--text-muted);
}

.toast-close:hover {
  color: var(--text);
}

/* Toast Progress Bar */
.toast-progress {
  @apply absolute bottom-0 left-0 h-[3px];
  background: currentColor;
  animation: toast-progress var(--toast-duration, 5s) linear forwards;
  opacity: 0.3;
}

@keyframes toast-progress {
  0% {
    width: 100%;
  }
  100% {
    width: 0%;
  }
}

.toast.success {
  border-left: 4px solid var(--success);
}

.toast.success i {
  color: var(--success);
}

.toast.success .toast-progress {
  background: var(--success);
}

.toast.error {
  border-left: 4px solid var(--danger);
}

.toast.error i {
  color: var(--danger);
}

.toast.error .toast-progress {
  background: var(--danger);
}

.toast.warning {
  border-left: 4px solid var(--warning);
}

.toast.warning i {
  color: var(--warning);
}

.toast.warning .toast-progress {
  background: var(--warning);
}

.toast.info {
  border-left: 4px solid var(--accent);
}

.toast.info i {
  color: var(--accent);
}

.toast.info .toast-progress {
  background: var(--accent);
}

/* ANIMATIONS */
.sidebar,
.main-wrapper,
.project-dropdown,
.modal-overlay,
.search-modal {
  @apply transition-all duration-[250ms] ease-[cubic-bezier(0.4,0,0.2,1)];
}

.modal-overlay {
  @apply animate-fade-in;
}

.search-modal {
  @apply animate-slide-down;
}

/* Skeleton loader */
.skeleton {
  @apply rounded animate-shimmer;
  background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-hover) 50%, var(--bg-tertiary) 75%);
  background-size: 200% 100%;
}

/* SETTINGS MODAL */
.settings-modal {
  @apply w-[90%] max-w-[500px] max-h-[80vh] overflow-auto rounded-2xl animate-slide-down;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
}

.settings-header {
  @apply flex items-center justify-between px-6 py-5;
  border-bottom: 1px solid var(--border);
}

.settings-header h3 {
  @apply m-0 flex items-center gap-3 text-lg;
}

.settings-header button {
  @apply bg-transparent border-none cursor-pointer text-lg p-1;
  color: var(--text-muted);
}

.settings-header button:hover {
  color: var(--text);
}

.settings-body {
  @apply px-6 py-5;
}

.settings-section {
  @apply mb-6;
}

.settings-section:last-child {
  @apply mb-0;
}

.settings-section h4 {
  @apply m-0 mb-4 text-[13px] uppercase tracking-wide flex items-center gap-2;
  color: var(--text-muted);
}

.settings-row {
  @apply flex gap-2.5 flex-wrap;
}

.settings-btn {
  @apply px-4 py-2.5 rounded-lg text-[13px] flex items-center gap-2 cursor-pointer transition-all duration-200;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text);
}

.settings-btn:hover {
  background: var(--bg-hover);
  border-color: var(--accent);
}

.settings-btn.accent {
  background: var(--accent);
  border-color: var(--accent);
  @apply text-white;
}

.settings-btn.accent:hover {
  background: var(--accent-hover);
}

.settings-option {
  @apply flex items-center gap-3 mb-3 text-sm;
}

.settings-option.indent {
  @apply pl-[52px];
}

.settings-option select {
  @apply px-3 py-2 rounded-md text-[13px];
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: var(--text);
}

/* Toggle Switch */
.toggle-switch {
  @apply relative w-11 h-6 inline-block;
}

.toggle-switch input {
  @apply opacity-0 w-0 h-0;
}

.toggle-slider {
  @apply absolute cursor-pointer inset-0 rounded-full transition-all duration-300;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
}

.toggle-slider:before {
  @apply absolute h-[18px] w-[18px] left-0.5 bottom-0.5 rounded-full transition-all duration-300;
  content: "";
  background: var(--text-muted);
}

.toggle-switch input:checked + .toggle-slider {
  background: var(--accent);
  border-color: var(--accent);
}

.toggle-switch input:checked + .toggle-slider:before {
  @apply translate-x-5 bg-white;
}

/* Accent Color Selector */
.accent-label {
  @apply text-[13px];
  color: var(--text-muted);
}

.accent-colors {
  @apply flex gap-2.5 flex-wrap mt-2;
}

.accent-btn {
  @apply w-9 h-9 rounded-full border-[3px] border-transparent cursor-pointer flex items-center justify-center text-sm text-white transition-all duration-200;
}

.accent-btn:hover {
  @apply scale-110;
}

.accent-btn.active {
  border-color: var(--text);
  box-shadow: 0 0 0 2px var(--bg-secondary);
}

/* Accent Color Themes */
.app[data-accent="indigo"] {
  --accent: #6366f1;
  --accent-hover: #818cf8;
}

.app[data-accent="blue"] {
  --accent: #3b82f6;
  --accent-hover: #60a5fa;
}

.app[data-accent="green"] {
  --accent: #22c55e;
  --accent-hover: #4ade80;
}

.app[data-accent="purple"] {
  --accent: #a855f7;
  --accent-hover: #c084fc;
}

.app[data-accent="rose"] {
  --accent: #f43f5e;
  --accent-hover: #fb7185;
}

.app[data-accent="orange"] {
  --accent: #f97316;
  --accent-hover: #fb923c;
}

.app[data-accent="cyan"] {
  --accent: #06b6d4;
  --accent-hover: #22d3ee;
}

/* Light mode accent adjustments */
.app.light[data-accent="indigo"] {
  --accent: #4f46e5;
  --accent-hover: #6366f1;
}

.app.light[data-accent="blue"] {
  --accent: #2563eb;
  --accent-hover: #3b82f6;
}

.app.light[data-accent="green"] {
  --accent: #16a34a;
  --accent-hover: #22c55e;
}

.app.light[data-accent="purple"] {
  --accent: #9333ea;
  --accent-hover: #a855f7;
}

.app.light[data-accent="rose"] {
  --accent: #e11d48;
  --accent-hover: #f43f5e;
}

.app.light[data-accent="orange"] {
  --accent: #ea580c;
  --accent-hover: #f97316;
}

.app.light[data-accent="cyan"] {
  --accent: #0891b2;
  --accent-hover: #06b6d4;
}
